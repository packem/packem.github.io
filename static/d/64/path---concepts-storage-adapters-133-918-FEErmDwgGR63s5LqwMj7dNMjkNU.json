{"data":{"site":{"siteMetadata":{"siteUrl":"https://docs.ghost.org","title":"Packem - A precompiled ES module bundler","description":"Everything you need to know about working with the Ghost professional publishing platform."}},"markdownRemark":{"frontmatter":{"title":"Storage Adapters","date":null,"date_pretty":null,"path":null,"meta_title":"Custom Storage Adapters for Ghost","meta_description":"Find out how to use custom storage adapters to store your publication's images to externally on S3, Google Drive, Azure, GitHub, Imgur and more.","image":null,"next":null,"sidebar":"concepts","toc":null,"keywords":["storage","concepts","ghost","publishing"]},"html":"<p>It's possible to send your publication's images to a 3rd party service, CDN or database using a custom storage module. </p>\n<h2 id=\"overview\"><a href=\"#overview\" aria-label=\"overview permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Overview</h2>\n<p>The storage layer is used to store images from an upload admin UI, from the API, and also when images are included in a zip file uploaded to the importer. Using a custom storage module allows you to change where images are stored without changing Ghost core. </p>\n<h2 id=\"using-a-custom-storage-adapter\"><a href=\"#using-a-custom-storage-adapter\" aria-label=\"using a custom storage adapter permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Using a custom storage adapter</h2>\n<p>By default Ghost stores images on your filesystem. The default location is the Ghost content path in your Ghost folder under <code class=\"language-text\">content/images</code>, or an alternative custom content path that you have configured. </p>\n<p>In order to use a custom storage adapter, your custom configuration file needs to be updated to provide config for your new storage module and set it as active:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">storage<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    active<span class=\"token operator\">:</span> 'my-module'<span class=\"token punctuation\">,</span>\n    'my-module'<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        key<span class=\"token operator\">:</span> 'abcdef'\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The storage block should have 2 items:</p>\n<ul>\n<li>An active key, which contains the name* of your module</li>\n<li>A key which reflects the name* of your module, containing any config your module needs</li>\n</ul>\n<h2 id=\"available-custom-storage-adapters\"><a href=\"#available-custom-storage-adapters\" aria-label=\"available custom storage adapters permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Available custom storage adapters</h2>\n<ul>\n<li><a href=\"https://github.com/TryGhost/Ghost/blob/0304816/core/server/storage/local-file-store.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">local-file-store</a> (default) saves images to the local filesystem</li>\n<li><a href=\"https://gist.github.com/ErisDS/559e11bf3e84b89a9594\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http-store passes</a> image requests through to an HTTP endpoint</li>\n<li><a href=\"https://github.com/spanishdict/ghost-s3-compat\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">s3-store</a> saves to Amazon S3 and proxies requests to S3</li>\n<li><a href=\"https://github.com/colinmeinke/ghost-storage-adapter-s3\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">s3-store</a> saves to Amazon S3 and works with 0.10+</li>\n<li><a href=\"https://github.com/Minwe/qn-store\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">qn-store</a> saves to Qiniu</li>\n<li><a href=\"https://github.com/mmornati/ghost-cloudinary-store\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ghost-cloudinary-store</a> saves to Cloudinary</li>\n<li><a href=\"https://github.com/eexit/ghost-storage-cloudinary\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ghost-storage-cloudinary</a> saves to Cloudinary with RetinaJS support</li>\n<li><a href=\"https://github.com/sanddudu/upyun-ghost-store\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">upyun-ghost-store</a> saves to Upyun</li>\n<li><a href=\"https://github.com/pupboss/ghost-upyun-store\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ghost-upyun-store</a> saves to Upyun</li>\n<li><a href=\"https://github.com/robincsamuel/ghost-google-drive\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ghost-google-drive</a> saves to Google Drive</li>\n<li><a href=\"https://github.com/tparnell8/ghost-azurestorage\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ghost-azure-storage</a> saves to Azure Storage</li>\n<li><a href=\"https://github.com/wrenth04/ghost-imgur\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ghost-imgur</a> saves to Imgur</li>\n<li><a href=\"https://github.com/thombuchi/ghost-google-cloud-storage\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">google-cloud-storage</a> saves to Google Cloud Storage</li>\n<li><a href=\"https://github.com/MT-Libraries/ghost-oss-store\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ghost-oss-store</a> saves to Aliyun OSS</li>\n<li><a href=\"https://github.com/martiendt/ghost-storage-adapter-b2\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ghost-b2</a> saves to Backblaze B2</li>\n<li><a href=\"https://github.com/ifvictr/ghost-github\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ghost-github</a> saves to GitHub</li>\n<li><a href=\"https://github.com/zce/pages-store\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">pages-store</a> saves to GitHub Pages or other pages service, e.g. Coding Pages</li>\n<li><a href=\"https://github.com/bartt/ghost-webdav-storage-adapter\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">WebDAV Storage</a> saves to a WebDAV server.</li>\n<li><a href=\"https://github.com/ZhelinCheng/ghost-qcloud-cos\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ghost-qcloud-cos</a> saves to Tencent Cloud COS.</li>\n</ul>\n<h2 id=\"creating-a-custom-storage-adapter\"><a href=\"#creating-a-custom-storage-adapter\" aria-label=\"creating a custom storage adapter permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Creating a custom storage adapter</h2>\n<p>In order to replace the storage module, use these requirements. You can also take a look at our <a href=\"https://github.com/TryGhost/Ghost/blob/master/core/server/adapters/storage/LocalFileStorage.js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">default local storage implementation</a>.</p>\n<h4 id=\"location\"><a href=\"#location\" aria-label=\"location permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Location</h4>\n<ol>\n<li>Create a new folder named <code class=\"language-text\">storage</code> inside <code class=\"language-text\">content/adapters</code></li>\n<li>Inside of <code class=\"language-text\">content/adapters/storage</code> create a file or a folder: <code class=\"language-text\">content/adapters/storage/my-module.js</code> or <code class=\"language-text\">content/adapters/storage/my-module</code> - if using a folder, create a file called <code class=\"language-text\">index.js</code> inside it</li>\n</ol>\n<h4 id=\"base-adapter-class-inheritance\"><a href=\"#base-adapter-class-inheritance\" aria-label=\"base adapter class inheritance permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Base adapter class inheritance</h4>\n<p>A custom storage adapter must inherit from your base storage adapter. By default the Base Storage Adapter is installed by Ghost and should be available in your custom adapter.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token string\">'use strict'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> BaseAdapter <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ghost-storage-base'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">MyCustomAdapter</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">BaseAdapter</span><span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> MyCustomAdapter<span class=\"token punctuation\">;</span></code></pre></div>\n<h4 id=\"required-methods\"><a href=\"#required-methods\" aria-label=\"required methods permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Required methods</h4>\n<p>Your custom storage adapter must implement five required functions: </p>\n<ul>\n<li><code class=\"language-text\">save</code> - The <code class=\"language-text\">.save()</code> method stores the image and returns a promise which resolves the path from which the image should be requested in future.</li>\n<li><code class=\"language-text\">exists</code> - Used by the base storage adapter to check whether a file exists or not</li>\n<li><code class=\"language-text\">serve</code> - Ghost calls <code class=\"language-text\">.serve()</code> as part of its middleware stack, and mounts the returned function as the middleware for serving images</li>\n<li><code class=\"language-text\">delete</code></li>\n<li><code class=\"language-text\">read</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token string\">'use strict'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> BaseAdapter <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ghost-storage-base'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">MyCustomAdapter</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">BaseAdapter</span><span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  \n  <span class=\"token function\">exists</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">serve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span> <span class=\"token function\">customServe</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">,</span> next</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">delete</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> MyCustomAdapter<span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"summary\"><a href=\"#summary\" aria-label=\"summary permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Summary</h2>\n<p>You have discovered how to use a custom storage module to replace the storage layer which handles images with custom code.</p>\n<p>It's good practise to create a public GitHub repository to make your module available for others and you can share your new module in our <a href=\"https://forum.ghost.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">forum</a>.</p>","fields":{"slug":"/concepts/storage-adapters/"},"timeToRead":4,"excerpt":"It's possible to send your publication's images to a 3rd party service, CDN or database using a custom storage module. OverviewThe storageâ€¦","fileAbsolutePath":"C:/Users/bukharim96/Desktop/Projects/docs/content/concepts/storage-adapters.md"}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/concepts/storage-adapters/"}}